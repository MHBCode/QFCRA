<app-loader *ngIf="isLoading"></app-loader>
<div class="error-messages">
  <p *ngIf="errorMessages['uploadDocument']">
    {{ errorMessages['uploadDocument'] }}
  </p>
</div>
<div class="inputs-row">
  <div class="file-container" *ngIf="isEdit && !tableDoc?.DocSubTypeDesc">

    <!-- Press Release -->
    <div class="input-field" *ngIf="shouldShowInputs() && pageName == Page.CoreDetail">
      <label for="documentType"> Document Type </label>
      <select class="document-type-select" name="documentType" id="documentType" [(ngModel)]="documentTypes.DocSubTypeID">
        <option [value]="0">Select</option>
        <option *ngFor="let type of documentTypes" [value]="type.DocSubTypeID">
          {{ type.DocSubTypeDesc }}
        </option>
      </select>
    </div>

    <!-- Scope of Authorisation -->
    <div class="input-field" *ngIf="shouldShowInputs() && pageName == Page.Scope">
      <label>Document Type</label>
      <select name="documentTypes" id="documentTypes" [(ngModel)]="documentTypes.DocSubTypeID">
        <option [value]="0">Select</option>
        <option *ngFor="let type of documentTypes" [value]="type.DocSubTypeID">
          {{ type.DocSubTypeDesc }}
        </option>
      </select>
    </div>

    <!-- Journal -->
    <div class="input-field" *ngIf="pageName == Page.SupervisionJournal">
      <label>Document Type</label>
      <select name="documentTypes" id="documentTypes" [(ngModel)]="documentTypes.DocSubTypeID">
        <option [value]="0">Select</option>
        <option *ngFor="let type of documentTypes" [value]="type.DocSubTypeID">
          {{ type.DocSubTypeDesc }}
        </option>
      </select>
    </div>

    <!-- Enforcement -->
    <div class="input-field" *ngIf="pageName == Page.Enforcement">
      <label>Document Type</label>
      <select name="documentTypes" id="documentTypes" [(ngModel)]="documentTypes.DocSubTypeID">
        <option [value]="0">Select</option>
        <option *ngFor="let type of documentTypes" [value]="type.DocSubTypeID">
          {{ type.DocSubTypeDesc }}
        </option>
      </select>
    </div>

    <!-- Registered Funds -->
    <div class="input-field" *ngIf="pageName == Page.RegisteredFunds">
      <label>Document Type</label>
      <select name="documentTypes" id="documentTypes" [(ngModel)]="documentTypes.DocSubTypeID">
        <option [value]="0">Select</option>
        <option *ngFor="let type of documentTypes" [value]="type.DocSubTypeID">
          {{ type.DocSubTypeDesc }}
        </option>
      </select>
    </div>


    <div class="input-field" style="flex-direction: row;" *ngIf="shouldShowButtons()">
      <label id="uploaded-documents"></label>
    </div>
    <div class="input-field" *ngIf="shouldShowButtons()">
      <div class="btns-container">
        <div class="upload-container">
          <button class="choose-document-btn" (click)="selectDocument()">
            Choose Document
          </button>
        </div>
        <button class="upload-document-btn" (click)="uploadDocument()">
          Upload the Document
        </button>
      </div>
    </div>
  </div>



  <div class="file-table-container">
    <table>
      <thead>
        <tr>
          <th>Document Type</th>
          <th>File Name</th>
          <th>Delete</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let doc of tableDoc">
          <td style="text-align: left">
            <span [style.color]="doc.DocSubTypeDesc ? 'inherit' : 'red'">
              {{ doc.DocSubTypeDesc || 'No documents attached' }}
            </span>
          </td>
          <td style="text-align: left">
            <a [href]="doc.fileLoc" target="_blank">{{ doc.FileName }}</a>
          </td>
          <td style="text-align: center">
            <button class="delete-action" *ngIf="doc.DocSubTypeDesc && isEdit" (click)="showAlertDeleteFile(doc)">
              Delete
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  
</div>
<!--Select Document PopUp-->
<div *ngIf="callUploadDoc" class="overlay show"></div>
<div *ngIf="callUploadDoc" class="selectDocumentPopUp">
  <button type="button" class="closeBtn" (click)="closeSelectDocument()">
    <i class="bi bi-x-circle close-icon"></i>
  </button>
  <div class="popup-info-place upload-container">
    <div class="popup-header">
      <h3>Upload {{ ismultiple ? 'Documents' : 'Document' }}</h3>
    </div>
    <div class="upload-document-body">
      <p>Please browse and upload/attach {{ ismultiple ? 'documents' : 'a document' }}:</p>
      <input type="file" accept=".pdf" [multiple]="ismultiple" #fileInput (change)="onFileSelected($event)" />
    </div>
    <small style="color: red" *ngIf="fileError">{{ fileError }}</small>
  </div>

  <div class="popup-operations-place">
    <button style="margin-right: 5px" class="subbutton" (click)="confirmOkUpload()">
      Ok
    </button>
    <button class="subbutton" (click)="closeSelectDocument()">Close</button>
  </div>
</div>